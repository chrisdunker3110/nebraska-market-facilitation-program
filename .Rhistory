title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
### TURN OFF SCIENTIFIC NOTATION
options(scipen = 999)
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
counties_merged$office, counties_merged$payment) %>%
lapply(htmltools::HTML)
labels <- sprintf(counties_merged$office, counties_merged$payment) %>%
lapply(htmltools::HTML)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
labels <- sprintf(
"<strong>%s</strong><br/>%g total received",
counties_merged$office, counties_merged$payment) %>%
lapply(htmltools::HTML)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
labels <- sprintf(
"<strong>%s</strong><br/>%g",
counties_merged$office, counties_merged$payment) %>%
lapply(htmltools::HTML)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
str(mfp_total)
View(mfp_total)
"<strong> counties_merged$office </strong><br/> counties_merged$payment",) %>%
lapply(htmltools::HTML)
labels <- sprintf("<h2>%s</h2> %s",
counties_merged$office, counties_merged$payment) %>%
lapply(htmltools::HTML)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
labels <- sprintf("<h2>%s</h2>%s",
counties_merged$office, counties_merged$payment) %>%
lapply(htmltools::HTML)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
labels <- sprintf("<strong>%s</strong>%s",
counties_merged$office, counties_merged$payment) %>%
lapply(htmltools::HTML)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
### LEFT JOIN COUNTY CODES TO MFP DATAFRAME
mfp = left_join(mfp, county_codes, by = "county") %>%
rename("cntycode" = "county", "city" = "city.x", "zip" = "new_zip", "office_city" = "city.y") %>%
### I FINALLY FOUND SMOETHING THAT WORKED TO REMOVE THE "COUNTY USDA SERV CNTR" FROM THE COUNTY ID.
### https://www.reddit.com/r/rstats/comments/b3s8ne/stringrstr_remove_is_there_an_easy_way_to_escape/
mutate(office = str_remove(office, "USDA Serv Cntr"))
mfp_counties = mfp %>%
mutate(office = str_remove(office, "FSA Office"))
### TRANSFORM DATA TO FIND OUT TOTAL RECEIVED BY COUNTY
mfp_total = mfp_counties %>%
group_by(cntycode, office) %>%
summarize(payment = sum(payment))
### JOIN TOGETHER COUNTY MAP, OFFICE DATA
counties_merged <- geo_join(ne, mfp_total, "COUNTYFP", "cntycode")
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
### JOIN TOGETHER COUNTY MAP, OFFICE DATA
counties_merged <- geo_join(ne, mfp_total, "COUNTYFP", "cntycode")
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
labels <- sprintf("<strong>%s</strong>%s<br></br>",
counties_merged$office, counties_merged$payment) %>%
lapply(htmltools::HTML)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
labels <- sprintf("<strong>%s</strong><br></br>%s",
counties_merged$office, counties_merged$payment) %>%
lapply(htmltools::HTML)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
labels <- sprintf("<strong>%s</strong>%s",
counties_merged$office, counties_merged$payment) %>%
lapply(htmltools::HTML)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
pal = colorBin("YlOrRd", domain = mfp_counties$payment, bins = risk.bins)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.2,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
### ANDREW'S CODE MODIFIED WITH MY DATA
leaflet() %>%
addProviderTiles("CartoDB.Positron") %>%
setView(-99.9018, 41,4925, zoom = 6) %>%
addPolygons(data = counties_merged,
fillColor = ~pal(counties_merged$payment),
fillOpacity = 1,
weight = 1,
smoothFactor = 0.5,
dashArray = "3",
color = "white",
highlight = highlightOptions(
weight = 5,
color = "blue",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE),
label = labels,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = pal,
values = counties_merged$payment,
position = "bottomleft",
title = "USDA Market Facilitation Program",
labFormat = labelFormat(prefix = "$"),
opacity = 1)
